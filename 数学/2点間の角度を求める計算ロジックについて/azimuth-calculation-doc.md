# 2点間の方位角計算の解説

## 座標系
- Y軸: 北(+)南(-)方向
- X軸: 東(+)西(-)方向
- 原点: 起点座標(x1, y1)
- 方位点: 目標座標(x2, y2)

## 方位角の定義
- 基準: 真北（Y軸の正の方向）を0°
- 回転方向: 時計回り
- 主要方向:
  - 北: 0°
  - 東: 90°
  - 南: 180°
  - 西: 270°

## 計算方法
方位角の計算は、X方向とY方向の変化量の大小関係により2つのパターンに分かれ、さらに象限によって補正が必要となります。

### 1. X方向の変化が大きい場合 (|ΔX| ≥ |ΔY|)
#### Case 1: 点が第1象限または第4象限（東側）
- 計算式: θ = Atn(ΔY/ΔX)
- 補正: 不要
- 特徴: 通常のアークタンジェントで算出

#### Case 2: 点が第2象限または第3象限（西側）
- 計算式: θ = Atn(ΔY/ΔX) + π
- 補正: πを加算
- 特徴: 180度の補正が必要

### 2. Y方向の変化が大きい場合 (|ΔX| < |ΔY|)
#### Case 3: 点が第1象限または第2象限（北側）
- 計算式: θ = π/2 - Atn(ΔX/ΔY)
- 補正: 不要
- 特徴: 90度からアークタンジェントを引く

#### Case 4: 点が第3象限または第4象限（南側）
- 計算式: θ = π/2 - Atn(ΔX/ΔY) + π
- 補正: πを加算
- 特徴: 180度の補正が必要

## 注意点
1. 距離が0の場合（2点が同じ位置）は方位角を計算できない
2. 計算結果は0〜2πの範囲に正規化される
3. 角度はラジアンで返却される
4. 数値計算の精度はDouble型に依存

## 使用例
```vb
' 北東45度の方向にある点の方位角を計算
Dim angle As Double
angle = azimuthAngle(0, 0, 1, 1)  ' 結果: π/4 ラジアン
```
